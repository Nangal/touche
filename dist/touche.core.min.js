/*! Touché - v1.0.3 - 2013-04-07
* https://github.com/stoffeastrom/touche/
* Copyright (c) 2013 Christoffer Åström, Andrée Hansson; Licensed MIT */
(function(t){"use strict";t.augment=function(t){var e=this.prototype,n=Object.create(e),s=t.call(n,this,e);return"function"!=typeof s&&(s=function(){}),n.constructor=s,s.prototype=n,s}})(Function.prototype),function(){"use strict";var t;t=window.Touche=function(e){if(e===void 0)throw Error("No element sent into Touche()");return this instanceof t?(this.elem=e,this.gestureHandler=t.cache.get(e),void 0):new t(e)},t.prototype.on=function(e,n){return t.prototype[e].call(this,n),this},t.prototype.off=function(e,n){return this.gestureHandler.gestures.filter(function(t){return e&&"*"!==e&&n?t.type===e&&t.id===n:e&&"*"===e&&n?t.id===n:e?t.type===e:!0}).forEach(function(t){t.off(this.elem),this.gestureHandler.removeGesture(t)},this),0===this.gestureHandler.gestures.length&&1===t.cache.data.length&&t.cache.remove(this.elem),this},t._gestures={},t.gestures={add:function(e,n){t._gestures[e]=n,t.prototype[e]=function(s){var i,o=new t.Binder(s);return i=new n(this.gestureHandler,e,o),this.gestureHandler.addGesture(i),i.on(this.elem),this}},get:function(e){return t._gestures[e]},remove:function(e){t._gestures[e]&&(t.cache.data.forEach(function(t){t.context.gestures.filter(function(t){return t.type===e}).forEach(function(e){t.context.removeGesture(e)})}),delete t.prototype[e],delete t._gestures[e])}}}(),function(t,e){"use strict";document.addEventListener("dragstart",function(){t.cache.data.forEach(function(t){t.context.cancelAllGestures()})},!1),t.GestureHandler=Object.augment(function(){function n(t){this.element=t,this.gestures=[],this.sortedGestures=[],this.data={},this.data.points=[],this.data.pointerIds=[],this.data.pagePoints=[],this.started=!1,this.ended=!1,this.relatedTarget=null}return this.activate=function(){this.on(this.element,t.utils.getEvents().start)},this.deactivate=function(){this.off(this.element,t.utils.getEvents().start),this.bindDoc(!1),t.cache.remove(this.element)},this.on=function(e,n){t.utils.msPointer&&(e.style&&e.style.msTouchAction?this.msTouchAction=e.style.msTouchAction:e.style||(e.style=""),e.style.msTouchAction="none"),e.addEventListener(n,this,!1)},this.off=function(e,n){e.removeEventListener(n,this,!1),t.utils.msPointer&&e.style&&(e.style.msTouchAction=this.msTouchAction)},this.reset=function(){this.gestures.forEach(function(t){t.started=!1,t.cancelled=!1,t.countTouches=0}),this.data={},this.data.pointerIds=[],this.data.points=[],this.data.pagePoints=[],this.started=!1,this.ended=!1,this.relatedTarget=null},this.trigger=function(e,n,s){this.sortedGestures.map(function(t){return t.context}).forEach(function(i){i.paused&&t.utils.isFunction(i[e])&&!i.cancelled?i.addPausedCallback(e,n,s):t.utils.isFunction(i[e])&&!i.cancelled&&i[e].call(i,n,s)},this)},this.play=function(t){t=t||!1,this.sortedGestures.map(function(t){return t.context}).filter(function(t){return t.paused}).forEach(function(e){e.play(t)})},this.pause=function(t,e){this.sortedGestures.map(function(t){return t.context}).filter(function(n){return t?e!==n&&t===n.type:e!==n}).forEach(function(t){t.pause()})},this.addGesture=function(t){this.gestures.push(t),this.sortGestures(),1===this.gestures.length&&this.activate()},this.removeGesture=function(t){this.gestures=this.gestures.filter(function(e){return e!==t}),this.sortGestures(),0===this.gestures.length&&this.deactivate()},this.removeGestures=function(t){this.gestures.filter(function(e){return t?e.type===t:!0}).forEach(function(t){this.removeGesture(t)},this)},this.cancelGesture=function(t){t.cancelled||(t.cancel.call(t),t.cancelled=!0)},this.cancelGestures=function(t){return this.gestures.filter(function(e){return e.type!==t}).forEach(function(t){this.cancelGesture(t)},this),this},this.cancelAllGestures=function(){this.bindDoc(!1),this.ended=!0,this.gestures.forEach(function(t){t.started&&this.cancelGesture(t)},this)},this.sortGestures=function(){this.sortedGestures=this.gestures.map(function(t){return{key:t.sortKey,context:t}}).sort(function(t,e){return t.key-e.key})},this.bindDoc=function(n){this[n?"on":"off"](e,t.utils.getEvents().move),this[n?"on":"off"](e,t.utils.getEvents().end),this[n?"on":"off"](e,t.utils.getEvents().cancel)},this.handleEvent=function(e){var n=t.utils.getEvents();switch(e.type){case n.start:this.started&&this.ended&&this.reset(),this.bindDoc(!0),this.relatedTarget=e.target,this.setPoints(e),this.trigger("start",e,this.data),this.started=!0;break;case n.move:this.setPoints(e),this.trigger("update",e,this.data);break;case n.end:this.bindDoc(!1),this.trigger("end",e,this.data),this.ended=!0;break;case n.cancel:this.bindDoc(!1),this.trigger("cancel",e,this.data)}},this.setPoints=function(e,n){n=n||"touches";var s,i,o,r,u;if(t.utils.touch)for(o=e[n],i=o.length,s=0;i>s;++s)this.data.points.length=i,this.data.pagePoints.length=i,this.data.points[s]=t.utils.transformPoint(this.relatedTarget,new t.Point(o[s].pageX,o[s].pageY)),this.data.pagePoints[s]=new t.Point(o[s].pageX,o[s].pageY);else t.utils.msPointer?(r=e.pointerId,u=this.data.pointerIds.indexOf(r),0>u&&(u=this.data.pointerIds.push(r)-1),i=this.data.pointerIds.length,this.data.points.length=i,this.data.pagePoints.length=i,this.data.points[u]=t.utils.transformPoint(this.relatedTarget,new t.Point(e.pageX,e.pageY)),this.data.pagePoints[u]=new t.Point(e.pageX,e.pageY)):(this.data.points.length=1,this.data.pagePoints.length=1,this.data.points[0]=t.utils.transformPoint(this.relatedTarget,new t.Point(e.pageX,e.pageY)),this.data.pagePoints[0]=new t.Point(e.pageX,e.pageY))},n})}(window.Touche,window.document),function(t,e,n){"use strict";var s=9;t.utils={noop:function(){},getSortKey:function(){return 5*++s},isSVG:function(t){return 1===t.nodeType&&"http://www.w3.org/2000/svg"===t.namespaceURI},closest:function(t,e){var n=function(t,e){return t.toUpperCase()===e.toUpperCase()},s=t.parentNode;if(!s)return null;if(n(t.tagName,e))return t;if(n(s.tagName,e))return s;for(;s;)if(s=s.parentNode,n(s.tagName,e))return s;return null},transformPoint:function(e,n){var s,i;return t.utils.isSVG(e)&&(s=t.utils.closest(e,"svg"))?(i=s.createSVGPoint(),i.x=n.x,i.y=n.y,i=i.matrixTransform(e.getScreenCTM().inverse()),new t.Point(i.x,i.y)):n},getRect:function(e){var n,s,i,o=window,r=o.document,u=r.body;return t.utils.isSVG(e)?(i=e.getBBox||e.getBoundingClientRect,n=i.call(e),new t.Rect(n.x||n.left||0,n.y||n.left||0,n.width,n.height)):(s=o!==e&&r!==e&&e.getBoundingClientRect?e:u,n=s.getBoundingClientRect(),new t.Rect(n.left+(o.scrollX||r.documentElement.scrollLeft),n.top+(o.scrollY||r.documentElement.scrollTop),n.width,n.height))},touch:"ontouchstart"in window,msPointer:window.navigator.msPointerEnabled,getEvent:function(t){switch(t){case"start":return this.msPointer?"MSPointerDown":this.touch?"touchstart":"mousedown";case"update":return this.msPointer?"MSPointerMove":this.touch?"touchmove":"mousemove";case"end":return this.msPointer?"MSPointerUp":this.touch?"touchend":"mouseup";case"cancel":return this.msPointer?"MSPointerCancel":this.touch?"touchcancel":"";default:throw"Not implemented!"}},getEvents:function(){return{start:this.getEvent("start"),move:this.getEvent("update"),end:this.getEvent("end"),cancel:this.getEvent("cancel")}},logger:function(t,e){if(t.touches){e=t[e||"touches"];var n="",s=e.length;n+="touches: "+s,n+=e.map(function(t){return"x:"+t.pageX+", "+t.pageY}).join(" "),window.console.log(n)}},isFunction:function(t){return"[object Function]"===Object.prototype.toString.call(t)},isArray:function(t){return Array.isArray(t)},isObject:function(t){return"[object Object]"===Object.prototype.toString.call(t)},getAngle:function(t,s){var i=t.x-s.x,o=t.y-s.y,r=e(o,i),u=180*r/n;return u=0>u?360+u:u},getDeltaAngle:function(t,s){var i=s.x-t.x,o=s.y-t.y,r=e(o,i),u=180*r/n;return u},getDirection:function(t){var e="invalid";return t>=0&&45>t||t>=315&&360>=t?e="right":t>=45&&135>t?e="down":t>=135&&225>t?e="left":t>=225&&315>t&&(e="up"),e},getVelocity:function(t,e,n,s){var i=t.distanceTo(e),o=s-n;return i/o}}}(window.Touche,Math.atan2,Math.PI),function(t){"use strict";t.cache={data:[],has:function(t){return this.data.filter(function(e){return e.elem===t})},get:function(e){var n=this.has(e);return 0===n.length?this.data[this.data.push({elem:e,context:new t.GestureHandler(e)})-1].context:n[0].context},remove:function(t){var e,n=this.has(t);n.length&&(e=this.data.indexOf(n[0]),this.data.splice(e,1))}}}(window.Touche),function(t){"use strict";t.Gesture=Object.augment(function(){function e(e,n,s){this.gestureHandler=e,this.type=n,this.binder=s,this.started=!1,this.cancelled=!1,this.pausedCallbacks=[],this.paused=!1,this.countTouches=0,this.options={},this.setOptions(),this.sortKey=this.options.precedence||t.utils.getSortKey(),this.id=this.binder.id}return this.on=t.utils.noop,this.off=t.utils.noop,this.start=t.utils.noop,this.update=t.utils.noop,this.end=t.utils.noop,this.cancel=function(){this.cancelled=!0},this.pause=function(){this.paused=!0},this.addPausedCallback=function(t,e,n){this.pausedCallbacks.push({action:t,event:e,data:n})},this.play=function(t){t&&!this.cancelled?this.pausedCallbacks.forEach(function(t){this[t.action].call(this,t.event,t.data)},this):this.gestureHandler.cancelGesture(this),this.paused=!1,this.pausedCallbacks=[]},this.setOptions=function(){Object.keys(this.defaults).forEach(function(t){this.options[t]=this.binder.options&&this.binder.options[t]!==void 0?this.binder.options[t]:this.defaults[t]},this)},this.hasMoreTouches=function(t){return this.countTouches=t.length>this.countTouches?t.length:this.countTouches,this.countTouches>0&&this.countTouches>this.options.touches},this.hasNotEqualTouches=function(t){return this.hasMoreTouches(t),this.countTouches>0&&this.countTouches!==this.options.touches},this.isValidMouseButton=function(e,n){if(t.utils.touch)return!0;if(t.utils.msPointer&&e.pointerType!==e.MSPOINTER_TYPE_MOUSE)return!0;var s,i=e.button,o=e.which;return s=o||void 0===i?o:1&i?1:2&i?3:4&i?2:0,s===n},e})}(window.Touche),function(t){"use strict";t.Binder=Object.augment(function(){function e(t){this.bind(t)}return this.start=t.utils.noop,this.update=t.utils.noop,this.end=t.utils.noop,this.cancel=t.utils.noop,this.bind=function(t){Object.keys(t||{}).forEach(function(e){this[e]=t[e]},this)},e})}(window.Touche),function(t,e,n,s){"use strict";t.Point=function(t,e){this.x=t,this.y=e},t.Point.prototype.distanceTo=function(t){var i=e(this.x-t.x),o=e(this.y-t.y),r=n(s(i,2)+s(o,2));return r}}(window.Touche,Math.abs,Math.sqrt,Math.pow),function(t){"use strict";t.Rect=function(t,e,n,s){this.x=t,this.y=e,this.width=n,this.height=s},t.Rect.prototype.pointInside=function(t,e){e=e||0;var n=this.x-e,s=this.y-e,i=this.x+this.width+e,o=this.y+this.height+e;return t.x>=n&&i>=t.x&&t.y>=s&&o>=t.y}}(window.Touche);